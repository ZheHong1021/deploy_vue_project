"use strict";(self["webpackChunkdeploy_vue_project"]=self["webpackChunkdeploy_vue_project"]||[]).push([[471],{4074:function(t,e,a){a.d(e,{A:function(){return h}});var s=a(7112),o=a(5803);const i=(0,o.A)(s.A);var l=i.extend({name:"v-textarea",props:{autoGrow:Boolean,noResize:Boolean,rowHeight:{type:[Number,String],default:24,validator:t=>!isNaN(parseFloat(t))},rows:{type:[Number,String],default:5,validator:t=>!isNaN(parseInt(t,10))}},computed:{classes(){return{"v-textarea":!0,"v-textarea--auto-grow":this.autoGrow,"v-textarea--no-resize":this.noResizeHandle,...s.A.options.computed.classes.call(this)}},noResizeHandle(){return this.noResize||this.autoGrow}},watch:{autoGrow(t){this.$nextTick((()=>{var e;t?this.calculateInputHeight():null===(e=this.$refs.input)||void 0===e||e.style.removeProperty("height")}))},lazyValue(){this.autoGrow&&this.$nextTick(this.calculateInputHeight)},rowHeight(){this.autoGrow&&this.$nextTick(this.calculateInputHeight)}},mounted(){setTimeout((()=>{this.autoGrow&&this.calculateInputHeight()}),0)},methods:{calculateInputHeight(){const t=this.$refs.input;if(!t)return;t.style.height="0";const e=t.scrollHeight,a=parseInt(this.rows,10)*parseFloat(this.rowHeight);t.style.height=Math.max(a,e)+"px"},genInput(){const t=s.A.options.methods.genInput.call(this);return t.tag="textarea",delete t.data.attrs.type,t.data.attrs.rows=this.rows,t},onInput(t){s.A.options.methods.onInput.call(this,t),this.autoGrow&&this.calculateInputHeight()},onKeyDown(t){this.isFocused&&13===t.keyCode&&t.stopPropagation(),this.$emit("keydown",t)}}}),n=function(){var t=this,e=t._self._c;return e(l,{attrs:{outlined:"",label:t.label,rows:t.rows,"row-height":t.rowHeight,clearable:t.clearable,"clear-icon":"mdi-close-circle","no-resize":"",placeholder:t.placeholder,value:t.value,readonly:t.readonly},on:{input:function(e){return t.$emit("input",e)}}})},r=[],d={name:"CustomTextArea",props:{value:{type:[String],default:null},label:{type:String,default:"請填寫內容"},placeholder:{type:String,default:"請開始填寫您想輸入的內容"},rules:{type:Array,default:()=>[]},rows:{type:Number,default:4},rowHeight:{type:Number,default:30},shaped:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1}}},c=d,u=a(1656),p=(0,u.A)(c,n,r,!1,null,null,null),h=p.exports},7852:function(t,e,a){a.r(e),a.d(e,{default:function(){return B}});var s=a(4414),o=a(3449),i=a(2756),l=function(){var t=this,e=t._self._c;return e(o.A,{attrs:{fluid:""}},[e(i.A,[e(s.A,{attrs:{cols:"12"}},[e("CustomDataTable",{attrs:{items:t.items,itemsLength:t.itemsLength,options:t.options,headers:t.headers,height:"500px",loading:t.loading,disabled_select:t.disabled_select,"fixed-header":!1,actions:["read","update"]},on:{emitUpdateOptions:t.emitUpdateOptions,read:t.emitRead,update:t.emitUpdate},scopedSlots:t._u([{key:"item.action",fn:function({item:t}){return[e("PermissionActionChip",{attrs:{action:t.action}})]}}])})],1)],1),e("CustomDialog",{attrs:{title:"瀏覽權限",color:"grey darken-2"},scopedSlots:t._u([{key:"body",fn:function(){return[t.read_dialog?e("ReadPermissionForm",{attrs:{id:t.read_id}}):t._e()]},proxy:!0}]),model:{value:t.read_dialog,callback:function(e){t.read_dialog=e},expression:"read_dialog"}}),e("CustomDialog",{attrs:{title:"修改權限",color:"primary darken-2"},scopedSlots:t._u([{key:"body",fn:function(){return[t.update_dialog?e("UpdatePermissionForm",{attrs:{id:t.update_id},on:{refresh:t.refreshData}}):t._e()]},proxy:!0}]),model:{value:t.update_dialog,callback:function(e){t.update_dialog=e},expression:"update_dialog"}})],1)},n=[],r=a(8521),d=a(6989),c=a(4846),u=a(4460),p=a(7112),h=function(){var t=this,e=t._self._c;return e(i.A,{staticClass:"justify-start"},[e(s.A,{staticClass:"d-flex flex-wrap gap-2",attrs:{cols:"12"}},[e("span",{staticClass:"label-container font-weight-bold text-subtitle-1"},[t._v(" 方法: ")]),e("PermissionActionChip",{attrs:{action:t.read_data["action"]}})],1),e(s.A,{staticClass:"d-flex flex-column gap-2",attrs:{cols:"12",md:"6"}},[e("div",{staticClass:"label-container font-weight-bold text-subtitle-1"},[t._v(" 操作代號: ")]),e(p.A,{attrs:{"background-color":"white",outlined:"",label:"",readonly:"",placeholder:"填寫範例: 操作代號"},model:{value:t.read_data["codename"],callback:function(e){t.$set(t.read_data,"codename",e)},expression:"read_data['codename']"}})],1),e(s.A,{staticClass:"d-flex flex-column gap-2",attrs:{cols:"12",md:"6"}},[e("div",{staticClass:"label-container font-weight-bold text-subtitle-1"},[t._v(" 操作對象: ")]),e(p.A,{attrs:{"background-color":"white",outlined:"",label:"",readonly:"",placeholder:"填寫範例: 操作對象"},model:{value:t.read_data["content_type_name"],callback:function(e){t.$set(t.read_data,"content_type_name",e)},expression:"read_data['content_type_name']"}})],1),e(s.A,{staticClass:"d-flex flex-column gap-2",attrs:{cols:"12"}},[e("div",{staticClass:"label-container font-weight-bold text-subtitle-1"},[t._v(" 操作說明: ")]),e("CustomTextArea",{attrs:{label:"",readonly:""},model:{value:t.read_data["name"],callback:function(e){t.$set(t.read_data,"name",e)},expression:"read_data['name']"}})],1)],1)},m=[],_=a(4074),f=a(3180),g=a(6930),b=function(){var t=this,e=t._self._c;return e(f.A,{staticClass:"w-max-content elevation-2 font-weight-bold black--text",attrs:{label:"",color:t.color}},[e(g.A,{attrs:{small:"",left:"",color:t.icon_color}},[t._v(" "+t._s(t.icon)+" ")]),t._v(" "+t._s(t.action)+" ")],1)},y=[],x={name:"PermissionActionChip",props:{action:{type:String,default:"查看"}},data(){return{style_hash_map:{"查看":{color:"success lighten-5",icon:"mdi-eye",icon_color:"success darken-2"},"新增":{color:"pink lighten-5",icon:"mdi-plus-circle",icon_color:"pink"},"修改":{color:"primary lighten-5",icon:"mdi-pencil",icon_color:"primary"},"刪除":{color:"error lighten-5",icon:"mdi-delete-circle",icon_color:"error"}}}},computed:{status_style(){return this.style_hash_map[this.action]},color(){return this.status_style["color"]},icon_color(){return this.status_style["icon_color"]},icon(){return this.status_style["icon"]}}},v=x,w=a(1656),A=(0,w.A)(v,b,y,!1,null,null,null),C=A.exports,k={name:"ReadPermissionForm",components:{CustomTextArea:_.A,PermissionActionChip:C},props:["id"],data(){return{loading:!0,read_data:{}}},watch:{id:{immediate:!0,handler(t){t&&this.fetchData()}}},methods:{async fetchData(){try{const t=await r.n1.get_by_id(this.id);200===t.status&&(this.read_data=t.data)}catch(t){console.error(t)}finally{this.loading=!1}}}},$=k,D=(0,w.A)($,h,m,!1,null,"4650e116",null),P=D.exports,F=a(3740),H=a(174),I=function(){var t=this,e=t._self._c;return e(H.A,{ref:"form",on:{submit:function(e){return e.preventDefault(),t.update.apply(null,arguments)}},model:{value:t.updateFormValid,callback:function(e){t.updateFormValid=e},expression:"updateFormValid"}},[e(i.A,{staticClass:"justify-start"},[e(s.A,{staticClass:"d-flex flex-wrap gap-2",attrs:{cols:"12"}},[e("span",{staticClass:"label-container font-weight-bold text-subtitle-1"},[t._v(" 方法: ")]),e("PermissionActionChip",{attrs:{action:t.response_data["action"]}})],1),e(s.A,{staticClass:"d-flex flex-column gap-2",attrs:{cols:"12",md:"6"}},[e("div",{staticClass:"label-container font-weight-bold text-subtitle-1"},[t._v(" 操作代號: ")]),e(p.A,{attrs:{"background-color":"white",outlined:"",label:"",readonly:"",disabled:"",hint:"無法修改","persistent-hint":"",placeholder:"填寫範例: 操作代號"},model:{value:t.response_data["codename"],callback:function(e){t.$set(t.response_data,"codename",e)},expression:"response_data['codename']"}})],1),e(s.A,{staticClass:"d-flex flex-column gap-2",attrs:{cols:"12",md:"6"}},[e("div",{staticClass:"label-container font-weight-bold text-subtitle-1"},[t._v(" 操作對象: ")]),e(p.A,{attrs:{"background-color":"white",outlined:"",label:"",readonly:"",disabled:"",hint:"無法修改","persistent-hint":"",placeholder:"填寫範例: 操作對象"},model:{value:t.response_data["content_type_name"],callback:function(e){t.$set(t.response_data,"content_type_name",e)},expression:"response_data['content_type_name']"}})],1),e(s.A,{staticClass:"d-flex flex-column gap-2",attrs:{cols:"12"}},[e("div",{staticClass:"label-container font-weight-bold text-subtitle-1"},[t._v(" 操作說明: "),e("strong",{staticClass:"red--text font-weight-bold text-caption text-left text-sm-right"},[t._v(" (*必填) ")])]),e("CustomTextArea",{attrs:{rules:[t.rules["requiredRules"]],label:"請填寫操作說明"},model:{value:t.update_data["name"],callback:function(e){t.$set(t.update_data,"name",e)},expression:"update_data['name']"}})],1),e(s.A,{staticClass:"d-flex align-center justify-center gap-4",attrs:{cols:"12"}},[e(F.A,{staticClass:"font-weight-bold white--text",attrs:{color:"primary darken-2",type:"submit",width:"150",height:"50"}},[t._v(" 儲存 ")])],1)],1)],1)},T=[],R={name:"UpdatePermissionForm",components:{CustomTextArea:_.A,PermissionActionChip:C},props:["id"],data(){return{loading:!0,response_data:{},update_data:{},updateFormValid:!1,rules:d.aO}},watch:{id:{immediate:!0,handler(t){t&&this.fetchData()}}},methods:{async fetchData(){try{const t=await r.n1.get_by_id(this.id);200===t.status&&(this.response_data=t.data,this.update_data={name:this.response_data["name"]})}catch(t){console.error(t)}finally{this.loading=!1}},async update(){if(this.$refs.form.validate(),this.updateFormValid)try{const t=new FormData;for(const[a,s]of Object.entries(this.update_data))null!==s&&void 0!==s&&t.append(a,s);const e=await r.n1.update(this.id,t);200===e.status?(this.$swal.fire("儲存成功","","success"),this.$emit("refresh"),this.$store.dispatch("permission/getPermissions")):this.$swal.fire("儲存失敗","","error")}catch(t){console.log(t),this.$swal.fire({title:"儲存發生錯誤",text:t,icon:"error"})}else this.$swal.fire("請確實填寫內容","","error")}}},S=R,U=(0,w.A)(S,I,T,!1,null,"64736962",null),G=U.exports,N={components:{CustomDataTable:c.A,CustomDialog:u.A,ReadPermissionForm:P,UpdatePermissionForm:G,PermissionActionChip:C},data(){return{dialog:!1,loading:!0,items:[],itemsLength:0,disabled_select:["id"],options:{page:1,itemsPerPage:30,sortBy:["id"],sortDesc:[!1]},headers:[{text:"編號",value:"id",sortable:!0},{text:"權限代號",value:"codename",sortable:!0},{text:"方法",value:"action",sortable:!0},{text:"操作",value:"actions",sortable:!1},{text:"權限說明",value:"name",sortable:!0},{text:"針對對象",value:"content_type_name",sortable:!1},{text:"權限標籤",value:"content_type_app_label",sortable:!1}],create_dialog:!1,read_dialog:!1,update_dialog:!1,read_id:null,update_id:null}},computed:{},async mounted(){await this.fetchData()},methods:{async fetchData(){this.loading=!0;try{const t=(0,d.UH)(this.options),e=await r.n1.get_all(t);if(200===e.status){const{data:t,count:a}=e.data;this.items=t,this.itemsLength=a}}catch(t){console.error(t)}finally{this.loading=!1}},emitUpdateOptions(t){this.options=t,this.fetchData()},async refreshData(){await this.fetchData(),this.create_dialog=!1,this.update_dialog=!1},emitRead(t){this.read_id=t,this.read_dialog=!0},emitUpdate(t){this.update_id=t,this.update_dialog=!0}}},z=N,j=(0,w.A)(z,l,n,!1,null,"250a6b50",null),B=j.exports}}]);
//# sourceMappingURL=471.448cc62a.js.map