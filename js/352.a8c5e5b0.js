"use strict";(self["webpackChunkdeploy_vue_project"]=self["webpackChunkdeploy_vue_project"]||[]).push([[352],{4352:function(t,e,a){a.r(e),a.d(e,{default:function(){return I}});var s=a(4414),l=a(3449),o=a(2756),r=function(){var t=this,e=t._self._c;return e(l.A,{attrs:{fluid:""}},[e(o.A,[e(s.A,{attrs:{cols:"12"}},[e("CustomDataTable",{attrs:{items:t.items,itemsLength:t.itemsLength,options:t.options,headers:t.headers,height:"100%",loading:t.loading,disabled_select:t.disabled_select,"fixed-header":!1,"show-expand":""},on:{emitUpdateOptions:t.emitUpdateOptions,create:t.emitCreate,read:t.emitRead,update:t.emitUpdate,delete:t.emitDelete},scopedSlots:t._u([{key:"item.status",fn:function({item:t}){return[e("td",[e("ProductStatus",{attrs:{product:t}})],1)]}}])})],1)],1),e("CustomDialog",{attrs:{title:"新增產品",color:"pink darken-2"},scopedSlots:t._u([{key:"body",fn:function(){return[t.create_dialog?e("CreateProductForm",{on:{refresh:t.refreshData}}):t._e()]},proxy:!0}]),model:{value:t.create_dialog,callback:function(e){t.create_dialog=e},expression:"create_dialog"}}),e("CustomDialog",{attrs:{title:"瀏覽產品",color:"grey darken-2"},scopedSlots:t._u([{key:"body",fn:function(){return[t.read_dialog?e("ReadProductForm",{attrs:{id:t.read_id}}):t._e()]},proxy:!0}]),model:{value:t.read_dialog,callback:function(e){t.read_dialog=e},expression:"read_dialog"}}),e("CustomDialog",{attrs:{title:"修改產品",color:"primary darken-2"},scopedSlots:t._u([{key:"body",fn:function(){return[t.update_dialog?e("UpdateProductForm",{attrs:{id:t.update_id},on:{refresh:t.refreshData}}):t._e()]},proxy:!0}]),model:{value:t.update_dialog,callback:function(e){t.update_dialog=e},expression:"update_dialog"}})],1)},i=[],n=a(9534),d=a(6989),c=a(7392),u=a(1651),h=a(3740),m=a(174),p=a(7112),f=function(){var t=this,e=t._self._c;return e(m.A,{ref:"form",on:{submit:function(e){return e.preventDefault(),t.create.apply(null,arguments)}},model:{value:t.createFormValid,callback:function(e){t.createFormValid=e},expression:"createFormValid"}},[e(o.A,{staticClass:"justify-start"},[e(s.A,{staticClass:"d-flex flex-column gap-2",attrs:{cols:"12",md:"6"}},[e("div",{staticClass:"label-container font-weight-bold text-subtitle-1"},[t._v(" 角色代號: "),e("strong",{staticClass:"red--text font-weight-bold text-caption text-left text-sm-right"},[t._v(" (*必填) ")])]),e(p.A,{attrs:{"background-color":"white",outlined:"",label:"請填寫角色代號",rules:[t.rules["requiredRules"]],placeholder:"填寫範例: role"},model:{value:t.create_data["name"],callback:function(e){t.$set(t.create_data,"name",e)},expression:"create_data['name']"}})],1),e(s.A,{staticClass:"d-flex flex-column gap-2",attrs:{cols:"12",md:"6"}},[e("div",{staticClass:"label-container font-weight-bold text-subtitle-1"},[t._v(" 角色名稱: "),e("strong",{staticClass:"red--text font-weight-bold text-caption text-left text-sm-right"},[t._v(" (*必填) ")])]),e(p.A,{attrs:{"background-color":"white",outlined:"",label:"請填寫角色名稱",rules:[t.rules["requiredRules"]],placeholder:"填寫範例: 角色"},model:{value:t.create_data["name_zh"],callback:function(e){t.$set(t.create_data,"name_zh",e)},expression:"create_data['name_zh']"}})],1),e(s.A,{staticClass:"d-flex align-center justify-center gap-4",attrs:{cols:"12"}},[e(h.A,{staticClass:"font-weight-bold white--text",attrs:{color:"pink darken-2",type:"submit",width:"150",height:"50"}},[t._v(" 創建 ")])],1)],1)],1)},_=[],g={name:"CreateProductForm",components:{},data(){return{create_data:{name:null,name_zh:null},createFormValid:!1,rules:d.aO}},computed:{},async mounted(){},methods:{async create(){if(this.$refs.form.validate(),this.createFormValid)try{const t=new FormData;for(const[a,s]of Object.entries(this.create_data))null!==s&&void 0!==s&&t.append(a,s);const e=await n.bk.create(t);201===e.status?(this.$swal.fire("創建成功","","success"),this.$emit("refresh")):this.$swal.fire("創建失敗","","error")}catch(t){console.error(t)}else this.$swal.fire("請確實填寫內容","","error")}}},b=g,x=a(1656),y=(0,x.A)(b,f,_,!1,null,"74a00225",null),v=y.exports,w=function(){var t=this,e=t._self._c;return e(o.A,{staticClass:"justify-start"},[e(s.A,{staticClass:"d-flex flex-column gap-2",attrs:{cols:"12",md:"6"}},[e("div",{staticClass:"label-container font-weight-bold text-subtitle-1"},[t._v(" 角色代號: ")]),e(p.A,{attrs:{"background-color":"white",outlined:"",label:"請填寫代號",readonly:"",placeholder:"填寫範例: role"},model:{value:t.read_data["name"],callback:function(e){t.$set(t.read_data,"name",e)},expression:"read_data['name']"}})],1),e(s.A,{staticClass:"d-flex flex-column gap-2",attrs:{cols:"12",md:"6"}},[e("div",{staticClass:"label-container font-weight-bold text-subtitle-1"},[t._v(" 角色名稱: ")]),e(p.A,{attrs:{"background-color":"white",outlined:"",label:"請填寫名稱",readonly:"",placeholder:"填寫範例: 角色"},model:{value:t.read_data["name_zh"],callback:function(e){t.$set(t.read_data,"name_zh",e)},expression:"read_data['name_zh']"}})],1)],1)},k=[],C={name:"ReadProductForm",components:{},props:["id"],data(){return{loading:!0,read_data:{name:null,name_zh:null}}},watch:{id:{immediate:!0,handler(t){t&&this.fetchData()}}},methods:{async fetchData(){try{const t=await n.bk.get_by_id(this.id);if(200===t.status){const e=t.data;this.read_data={name:e["name"],name_zh:e["name_zh"]}}}catch(t){console.error(t)}finally{this.loading=!1}}}},A=C,D=(0,x.A)(A,w,k,!1,null,"ee6000a4",null),F=D.exports,$=function(){var t=this,e=t._self._c;return e(m.A,{ref:"form",on:{submit:function(e){return e.preventDefault(),t.update.apply(null,arguments)}},model:{value:t.updateFormValid,callback:function(e){t.updateFormValid=e},expression:"updateFormValid"}},[e(o.A,{staticClass:"justify-start"},[e(s.A,{staticClass:"d-flex flex-column gap-2",attrs:{cols:"12",md:"6"}},[e("div",{staticClass:"label-container font-weight-bold text-subtitle-1"},[t._v(" 角色代號: "),e("strong",{staticClass:"red--text font-weight-bold text-caption text-left text-sm-right"},[t._v(" (*必填) ")])]),e(p.A,{attrs:{"background-color":"white",outlined:"",label:"請填寫代號",rules:[t.rules["requiredRules"]],placeholder:"填寫範例: teacher"},model:{value:t.update_data["name"],callback:function(e){t.$set(t.update_data,"name",e)},expression:"update_data['name']"}})],1),e(s.A,{staticClass:"d-flex flex-column gap-2",attrs:{cols:"12",md:"6"}},[e("div",{staticClass:"label-container font-weight-bold text-subtitle-1"},[t._v(" 角色名稱: "),e("strong",{staticClass:"red--text font-weight-bold text-caption text-left text-sm-right"},[t._v(" (*必填) ")])]),e(p.A,{attrs:{"background-color":"white",outlined:"",label:"請填寫名稱",rules:[t.rules["requiredRules"]],placeholder:"填寫範例: 老師"},model:{value:t.update_data["name_zh"],callback:function(e){t.$set(t.update_data,"name_zh",e)},expression:"update_data['name_zh']"}})],1),e(s.A,{staticClass:"d-flex align-center justify-center gap-4",attrs:{cols:"12"}},[e(h.A,{staticClass:"font-weight-bold white--text",attrs:{color:"primary darken-2",type:"submit",width:"150",height:"50"}},[t._v(" 儲存 ")])],1)],1)],1)},z=[],P={name:"UpdateProductForm",components:{},props:["id"],data(){return{loading:!0,update_data:{},updateFormValid:!1,rules:d.aO}},watch:{id:{immediate:!0,handler(t){t&&this.fetchData()}}},methods:{async fetchData(){try{const t=await n.bk.get_by_id(this.id);if(200===t.status){const e=t.data;this.update_data={name:e["name"],name_zh:e["name_zh"]}}}catch(t){console.error(t)}finally{this.loading=!1}},async update(){if(this.$refs.form.validate(),this.updateFormValid)try{const t=new FormData;for(const[a,s]of Object.entries(this.update_data))null!==s&&void 0!==s&&t.append(a,s);const e=await n.bk.update(this.id,t);200===e.status?(this.$swal.fire("儲存成功","","success"),this.$emit("refresh")):this.$swal.fire("儲存失敗","","error")}catch(t){console.error(t)}else this.$swal.fire("請確實填寫內容","","error")}}},V=P,j=(0,x.A)(V,$,z,!1,null,"60854d93",null),R=j.exports,U=a(3180),O=a(6930),S=function(){var t=this,e=t._self._c;return e(U.A,{staticClass:"elevation-2 font-weight-bold black--text",attrs:{label:"",color:t.status_style["color"]}},[e(O.A,{attrs:{small:"",left:"",color:t.status_style["icon_color"]}},[t._v("circle")]),t._v(" "+t._s(t.product["status_display"])+" ")],1)},q=[],L={name:"ProductStatus",props:{product:{type:Object,default:()=>{}}},data(){return{status_style_map:{available:{color:"primary lighten-4",icon_color:"primary"},out_of_stock:{color:"error lighten-4",icon_color:"error"},discontinued:{color:"grey lighten-2",icon_color:"grey darken-2"}}}},computed:{status_style(){const{status:t}=this.product;return this.status_style_map[t]}}},T=L,B=(0,x.A)(T,S,q,!1,null,"5f47d7b8",null),H=B.exports,J={components:{CustomDataTable:c.A,CustomDialog:u.A,ProductStatus:H,CreateProductForm:v,ReadProductForm:F,UpdateProductForm:R},data(){return{dialog:!1,loading:!0,items:[],itemsLength:0,disabled_select:["name"],options:{page:1,itemsPerPage:30,sortBy:["name"],sortDesc:[!1]},headers:[{text:"產品名稱",value:"name",sortable:!0},{text:"操作",value:"actions",sortable:!0},{text:"種類",value:"category_name",sortable:!0},{text:"狀態",value:"status",sortable:!0},{text:"價格",value:"price",sortable:!0},{text:"庫存",value:"stock",sortable:!0}],create_dialog:!1,read_dialog:!1,update_dialog:!1,read_id:null,update_id:null}},computed:{},async mounted(){await this.fetchData()},methods:{async fetchData(){this.loading=!0;try{const t=(0,d.UH)(this.options),e=await n.bk.get_all(t);if(200===e.status){const{data:t,count:a}=e.data;this.items=t,this.itemsLength=a}}catch(t){console.error(t)}finally{this.loading=!1}},emitUpdateOptions(t){this.options=t,this.fetchData()},async refreshData(){await this.fetchData(),this.create_dialog=!1,this.update_dialog=!1},emitCreate(){this.create_dialog=!0},emitRead(t){this.read_id=t,this.read_dialog=!0},emitUpdate(t){this.update_id=t,this.update_dialog=!0},async emitDelete(t){const e=await(0,d.d4)();if(e.isConfirmed){const e=await(0,d.JV)();if(e)try{const e=await n.bk.delete(t);204===e.status&&(this.$swal.fire("刪除成功","","success"),await this.fetchData())}catch(a){this.$swal.fire("刪除失敗",a,"error")}}}}},E=J,G=(0,x.A)(E,r,i,!1,null,"59eb5843",null),I=G.exports}}]);
//# sourceMappingURL=352.a8c5e5b0.js.map